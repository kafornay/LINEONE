<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyO9P-RpXnQGQFXoYEKyIV6VIg56KVpf37zkpLoeVSy56idoKpdzyfJjcmp-rGou99I/exec"; // Exemplo: https://script.google.com/macros/s/AKfycb.../exec
const WHATSAPP = "5522999631760"; // seu n√∫mero no formato internacional

async function carregarProdutos() {
  const container = document.getElementById("produtos");
  container.innerHTML = "‚è≥ Carregando produtos...";
  try {
    const res = await fetch(SCRIPT_URL);
    const data = await res.json();
    const produtos = data.produtos || [];
    if (!produtos.length) {
      container.innerHTML = "Nenhum produto dispon√≠vel no momento.";
      return;
    }
    container.innerHTML = "";
    produtos.forEach(prod => {
      const card = document.createElement("div");
      card.className = "card";
      let imagem = prod.ImagemBase64 || "";
      if (imagem && !imagem.startsWith("data:image")) {
        imagem = imagem; // j√° √© um link
      } else if (!imagem) {
        imagem = "https://via.placeholder.com/300x200?text=Sem+Imagem";
      }
      const estoque = parseInt(prod.Estoque) || 0;
      card.innerHTML = `
        <img src="${imagem}" alt="${prod.Nome}">
        <div class="card-content">
          <h3>${prod.Nome}</h3>
          <p>${prod.Descri√ß√£o || ""}</p>
          <div class="price">R$ ${Number(prod.Pre√ßo).toFixed(2)}</div>
          ${
            estoque > 0
              ? `<button onclick="comprar('${encodeURIComponent(prod.Nome)}', '${encodeURIComponent(prod.Pre√ßo)}')">üõí Comprar</button>`
              : `<button class="esgotado" onclick="avisar('${encodeURIComponent(prod.Nome)}')">üîî Avisar quando chegar</button>`
          }
        </div>
      `;
      container.appendChild(card);
    });
  } catch (erro) {
    console.error(erro);
    container.innerHTML = "‚ùå Erro ao carregar produtos.";
  }
}

function comprar(nome, preco) {
  nome = decodeURIComponent(nome);
  preco = decodeURIComponent(preco);
  const msg = `Ol√°! Quero comprar o produto *${nome}* por R$${preco}.`;
  const link = `https://wa.me/${WHATSAPP}?text=${encodeURIComponent(msg)}`;
  window.open(link, "_blank");
}

function avisar(nome) {
  nome = decodeURIComponent(nome);
  const msg = `Ol√°! Quero ser avisado quando o produto *${nome}* voltar ao estoque.`;
  const link = `https://wa.me/${WHATSAPP}?text=${encodeURIComponent(msg)}`;
  window.open(link, "_blank");
}

carregarProdutos();
</script>

