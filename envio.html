<script>
    // URL que voc√™ me forneceu:
    const APP_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzqod3GjO7m5bFed-KNxaTKVl9uR-hCePwCjMLnpblR-GFOqoXZVF4UHqXtWrZZVaxfVg/exec';

    async function enviar() {
        const fileInput = document.getElementById('fileInput');
        const file = fileInput.files[0];
        
        if (!file) return alert('Selecione uma imagem!');

        document.getElementById('status').textContent = '‚è≥ Enviando... Por favor, aguarde.';
        document.getElementById('link').innerHTML = '';

        const reader = new FileReader();
        
        reader.onload = async () => {
            try {
                const base64Data = reader.result.split(',')[1];
                
                // üõë NOVO: Montar o objeto JSON para envio
                const payload = {
                    data: base64Data,
                    filename: file.name
                };

                const response = await fetch(APP_SCRIPT_URL, {
                    method: 'POST',
                    // üõë MUDAN√áA CR√çTICA: Content-Type agora √© JSON
                    headers: { 
                        'Content-Type': 'application/json' 
                    }, 
                    // Enviar o objeto JSON stringificado
                    body: JSON.stringify(payload) 
                });

                const data = await response.json();
                
                if (data.success) {
                    document.getElementById('status').textContent = '‚úÖ Enviado com sucesso!';
                    document.getElementById('link').innerHTML = `<a href="${data.link}" target="_blank">Abrir imagem no Drive</a>`;
                } else {
                    document.getElementById('status').textContent = '‚ùå Erro: ' + data.error;
                }
            } catch (err) {
                // Este erro ('Failed to fetch') que voc√™ estava tendo deve parar agora
                document.getElementById('status').textContent = '‚ùå Erro de Comunica√ß√£o: ' + err.message;
            }
        };
        reader.readAsDataURL(file);
    }
</script>
